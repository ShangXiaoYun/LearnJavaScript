<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promise.all批量获取数据</title>
    <script src="js/ajax.js"></script>
</head>
<body>
    <script>
        // const sophie = new Promise((resolve,reject) => {
        //     setTimeout(()=>{
        //         // resolve("第一个异步");
        //         reject("fail");
        //     },1000);
        // }).catch(error => {
        //     console.log(error);
        // });

        // const sophie2 = new Promise((resolve,reject) => {
        //     setTimeout(()=>{
        //         resolve("第二个异步");
        //     },1000);
        // });
        // //如果所有的Promise的状态是成功的，接口all就是成功的，
        // //只要有一个Promise的状态时拒绝的，接口all就是失败的
        // Promise.all([sophie,sophie2]).then(result => {
        //     console.log(result);
        // }).catch(error => {
        //     console.log(error);
        // });

        //根据用户批量获取用户资料
        // const promises = ['后盾人','向军'].map(name => {
        //     return ajax(`http://localhost:8888/php/user.php?name=${name}`)
        // })
        // Promise.all(promises).then(users => {
        //     console.log(users);
        // })

        function getUsers(names){
            let promises = names.map(name => {
                return ajax(`http://localhost:8888/php/user.php?name=${name}`)
            });
            return Promise.all(promises); 
        }

        getUsers(['后盾人','向军']).then(users => {
            console.log(users);
        });
    </script>
</body>
</html>