<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>手写Promise</title>
    <script src="HD.js"></script>
</head>
<body>
    <script>
        let p = new HD((resolve,reject) =>{
            setTimeout(()=>{
                resolve("解决");
                // console.log("sophie2");
                // reject("拒绝");
            },1000);
        }).then()
        .then(value => {
            // throw new Error("fail");
            // console.log(asc);
            console.log(value);
            // console.log(agw);
            return "小猫";
        },reason => {
            console.log(reason);
            return "下雨天";
        }).then(value => {
            console.log("success" + value);
        },reason => {
            console.log("Error " + reason);
        });
        console.log("Sophie");

        //测试返回Promise
        // let p = new HD((resolve,reject) =>{
        //     // resolve("解决");
        //     // reject("拒绝");
        //     setTimeout(()=>{
        //         resolve('解决');
        //     },1000);
        // }).then(value=>{        
        //     return new HD((resolve,reject) => {
        //         resolve("Sophie");
        //         // reject("fail");
        //     });
        // },reason => {
        //     return new HD((resolve,reject) => {
        //         reject("Sophie");
        //         // reject("fail");
        //     });
        // }).then(value => {
        //     console.log(value);
        // },reason => {
        //     console.log("rejected " + reason);
        // });

        // let promise = new HD((resolve,reject)=>{
        //     resolve("解决");
        // });
        //这种是报错的
        // let p = promise.then(value =>{
        //     return p;
        // });

        // let p = new HD((resolve,reject) => {
        //     // resolve("成功");
        //     reject("失败!");
        // });
        // HD.resolve(p).then(value => {
        //     console.log(value);
        // },reason => {
        //     console.log(reason);
        // })

        // HD.reject("失败!").then(null,reason => {
        //     console.log(reason);
        // })

        //Promise.all
        // let p1 = new HD(resolve =>{
        //     resolve("sophie");
        // });
        // let p2 = new HD((resolve,reject)=>{
        //     resolve("小鱼");
        //     // reject("拒绝");
        // });
        // HD.all([p1,p2]).then(value =>{
        //     console.log(value);
        // },reason =>{
        //     console.log(reason);
        // });

        // Promise.race测试
        // let p1 = new HD(resolve =>{
        //     setTimeout(()=>{
        //         resolve("sophie");
        //     },2000);
        // });
        // let p2 = new HD((resolve,reject)=>{
        //     setTimeout(()=>{
        //         // resolve("小鱼");
        //         reject("拒绝");
        //     },1000)
        // });
        // HD.race([p1,p2]).then(value =>{
        //     console.log(value);
        // },reason =>{
        //     console.log(reason);
        // });


        let p1 = new HD((resolve,reject) =>{
            resolve("解决");
        });
        let p2 = new HD((resolve,reject) => {
            resolve('小猫');
        });
        //两个前部解决
        HD.all([p1,p2]).then(value =>{
            console.log(value);
        },reason =>{
            console.log(reason);
        });
    </script>
</body>
</html>